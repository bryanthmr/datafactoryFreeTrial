{
	"name": "powerquery1",
	"properties": {
		"type": "WranglingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "CustomersCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CustomersCSV",
					"dataset": {
						"referenceName": "CustomersCSV",
						"type": "DatasetReference"
					}
				},
				{
					"name": "OrdersCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> OrdersCSV",
					"dataset": {
						"referenceName": "OrdersCSV",
						"type": "DatasetReference"
					}
				},
				{
					"name": "ProductsCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ProductsCSV",
					"dataset": {
						"referenceName": "ProductsCSV",
						"type": "DatasetReference"
					}
				}
			],
			"script": "section Section1;\r\nshared CustomersCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/customers.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.None]) in Csv;\r\nshared OrdersCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/orders.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.Csv]), PromotedHeaders = Table.PromoteHeaders(Csv, [PromoteAllScalars = true]) in  PromotedHeaders;\r\nshared ProductsCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/products.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.Csv]), PromotedHeaders = Table.PromoteHeaders(Csv, [PromoteAllScalars = true]) in  PromotedHeaders;\r\nshared UserQuery = let Source = #\"CustomersCSV\",\n  #\"Requêtes fusionnées\" = Table.NestedJoin(Source, {\"Column1\"}, OrdersCSV, {\"id_customer\"}, \"OrdersCSV\", JoinKind.LeftOuter),\n  #\"OrdersCSV développé\" = Table.ExpandTableColumn(#\"Requêtes fusionnées\", \"OrdersCSV\", {\"order_datetime\", \"id_product\", \"quantity\"}, {\"order_datetime\", \"id_product\", \"quantity\"}),\n  #\"Requêtes fusionnées 1\" = Table.NestedJoin(#\"OrdersCSV développé\", {\"id_product\"}, ProductsCSV, {\"product_id\"}, \"ProductsCSV\", JoinKind.LeftOuter),\n  #\"ProductsCSV développé\" = Table.ExpandTableColumn(#\"Requêtes fusionnées 1\", \"ProductsCSV\", {\"product_name\", \"unit_price\"}, {\"product_name\", \"unit_price\"}),\n  #\"Colonnes renommées\" = Table.RenameColumns(#\"ProductsCSV développé\", {{\"Column1\", \"id_customer\"}}),\n  #\"Inserted Merged Column\" = Table.AddColumn(#\"Colonnes renommées\", \"customer_name\", each Text.Combine({[Column2], \" \", [Column3]}), type text),\n  #\"Colonnes permutées\" = Table.ReorderColumns(#\"Inserted Merged Column\", {\"id_customer\", \"customer_name\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"order_datetime\", \"id_product\", \"quantity\", \"product_name\", \"unit_price\"}),\n  #\"Colonnes supprimées\" = Table.RemoveColumns(#\"Colonnes permutées\", {\"Column2\", \"Column3\"}),\n  #\"Colonnes renommées 1\" = Table.RenameColumns(#\"Colonnes supprimées\", {{\"Column4\", \"age\"}}),\n  #\"Colonnes renommées 2\" = Table.RenameColumns(#\"Colonnes renommées 1\", {{\"Column5\", \"groupe_client\"}, {\"order_datetime\", \"order_month\"}}) in #\"Colonnes renommées 2\";\r\n",
			"documentLocale": "en-us"
		}
	}
}