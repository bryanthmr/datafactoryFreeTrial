{
	"name": "powerquery1",
	"properties": {
		"type": "WranglingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "CustomersCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CustomersCSV",
					"dataset": {
						"referenceName": "CustomersCSV",
						"type": "DatasetReference"
					}
				},
				{
					"name": "OrdersCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> OrdersCSV",
					"dataset": {
						"referenceName": "OrdersCSV",
						"type": "DatasetReference"
					}
				},
				{
					"name": "ProductsCSV",
					"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> ProductsCSV",
					"dataset": {
						"referenceName": "ProductsCSV",
						"type": "DatasetReference"
					}
				}
			],
			"script": "section Section1;\r\nshared CustomersCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/customers.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.None]) in Csv;\r\nshared OrdersCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/orders.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.Csv]), PromotedHeaders = Table.PromoteHeaders(Csv, [PromoteAllScalars = true]) in  PromotedHeaders;\r\nshared ProductsCSV = let AdfDoc = AzureStorage.BlobContents(\"https://stockagebth.blob.core.windows.net/ordersdata/data/products.csv\"),Csv = Csv.Document(AdfDoc, [Delimiter = \",\", Encoding = TextEncoding.Utf8, QuoteStyle = QuoteStyle.Csv]), PromotedHeaders = Table.PromoteHeaders(Csv, [PromoteAllScalars = true]) in  PromotedHeaders;\r\nshared UserQuery = let Source = #\"CustomersCSV\",\r\n  #\"Requêtes fusionnées\" = Table.NestedJoin(Source, {\"Column1\"}, OrdersCSV, {\"id_customer\"}, \"OrdersCSV\", JoinKind.LeftOuter),\r\n  #\"OrdersCSV développé\" = Table.ExpandTableColumn(#\"Requêtes fusionnées\", \"OrdersCSV\", {\"order_datetime\", \"id_product\", \"quantity\"}, {\"order_datetime\", \"id_product\", \"quantity\"}),\r\n  #\"Requêtes fusionnées 1\" = Table.NestedJoin(#\"OrdersCSV développé\", {\"id_product\"}, ProductsCSV, {\"product_id\"}, \"ProductsCSV\", JoinKind.LeftOuter),\r\n  #\"ProductsCSV développé\" = Table.ExpandTableColumn(#\"Requêtes fusionnées 1\", \"ProductsCSV\", {\"product_name\", \"unit_price\"}, {\"product_name\", \"unit_price\"}),\r\n  #\"Colonnes renommées\" = Table.RenameColumns(#\"ProductsCSV développé\", {{\"Column1\", \"id_customer\"}}),\r\n  #\"Inserted Merged Column\" = Table.AddColumn(#\"Colonnes renommées\", \"customer_name\", each Text.Combine({[Column2], \" \", [Column3]}), type text),\r\n  #\"Colonnes permutées\" = Table.ReorderColumns(#\"Inserted Merged Column\", {\"id_customer\", \"customer_name\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"order_datetime\", \"id_product\", \"quantity\", \"product_name\", \"unit_price\"}),\r\n  #\"Colonnes supprimées\" = Table.RemoveColumns(#\"Colonnes permutées\", {\"Column2\", \"Column3\"}),\r\n  #\"Type de colonne changé\" = Table.TransformColumnTypes(#\"Colonnes supprimées\", {{\"id_customer\", Int64.Type}}),\r\n  #\"Colonnes renommées 1\" = Table.RenameColumns(#\"Type de colonne changé\", {{\"Column4\", \"age\"}}),\r\n  #\"Type de colonne changé 1\" = Table.TransformColumnTypes(#\"Colonnes renommées 1\", {{\"age\", Int64.Type}}),\r\n  #\"Colonnes renommées 2\" = Table.RenameColumns(#\"Type de colonne changé 1\", {{\"Column5\", \"groupe_client\"}}),\r\n  #\"Type de colonne changé 2\" = Table.TransformColumnTypes(#\"Colonnes renommées 2\", {{\"groupe_client\", Int64.Type}}),\r\n  #\"Colonnes renommées 3\" = Table.RenameColumns(#\"Type de colonne changé 2\", {{\"order_datetime\", \"order_month\"}}),\r\n  #\"Inserted Month\" = Table.AddColumn(#\"Colonnes renommées 3\", \"Month\", each Date.Month(DateTime.From([order_month])), Int64.Type),\r\n  #\"Colonnes supprimées 1\" = Table.RemoveColumns(#\"Inserted Month\", {\"order_month\"}),\r\n  #\"Colonnes permutées 1\" = Table.ReorderColumns(#\"Colonnes supprimées 1\", {\"id_customer\", \"customer_name\", \"age\", \"groupe_client\", \"Month\", \"id_product\", \"quantity\", \"product_name\", \"unit_price\"}),\r\n  #\"Colonnes renommées 4\" = Table.RenameColumns(#\"Colonnes permutées 1\", {{\"Month\", \"order_month\"}}) in #\"Colonnes renommées 4\";\r\n",
			"documentLocale": "en-us"
		}
	}
}